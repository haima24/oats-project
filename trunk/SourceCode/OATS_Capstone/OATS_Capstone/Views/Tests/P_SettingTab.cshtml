@model OATS_Capstone.Models.Test
@{
    var settingConfig = Model.SettingConfig;
    var groups = from settings in settingConfig.SettingConfigDetails
                 group settings by new {KeyName=settings.SettingType.SettingGroupName,KeyOrder=settings.SettingType.SettingGroupOrder} into settingGroup
                 select new { GroupKey= settingGroup.Key, Items = settingGroup };
    var groupsSorted = groups.OrderBy(i => i.GroupKey.KeyOrder);
    var authen = OATS_Capstone.Models.AuthenticationSessionModel.Instance();
    var isOwner = authen.UserId == Model.CreatedUserID;
    ViewBag.isOwner = isOwner;
}
<div class="nt-asm-settings" style="height: 400px; overflow-y: auto;">
    <div class="nt-panel">
        @foreach (var setting in groupsSorted)
        { 
            <div class="nt-section">
                <div class="nt-header">@setting.GroupKey.KeyName</div>
                <ul>
                    @{
            var sortedItems = setting.Items.OrderBy(k => k.SettingType.SettingInGroupOrder);
                    }
                    @foreach (var item in sortedItems)
                    {
                        <li>
                            @Html.Partial("P_SettingTab_ConfigDetail", item)
                        </li>
                    }
                </ul>
            </div>
        }
    </div>
</div>
